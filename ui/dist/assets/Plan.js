import{_ as mt,a as ht,b as Ht,c as Gt}from"./SlickOperatorSelect.js";import{_ as He}from"./HelpText.js";import{ar as Kt,as as Ye,B as Qt,ax as Jt,bH as Xt,r as D,b as Zt,aI as Yt,ay as gt,j as L,aA as en,I as tn,H as re,aB as nn,E as je,M as rn,aL as he,bJ as _t,d as de,br as Ge,bI as sn,w as Ke,bs as b,bC as M,bx as l,F as V,bD as K,bK as on,bo as u,bL as te,bw as se,aC as et,bM as tt,bE as nt,bv as d,bu as p,bt as oe,k as E,n as an,b3 as vt,bF as Qe,bG as Je,by as ln,i as bt,b9 as un,bm as fe,D as Re,az as rt,aX as cn}from"./_plugin-vue_export-helper.js";import{f as dn,b as fn,d as pn,e as We,V as mn,g as hn,h as gn,i as _n,j as vn,l as bn,m as wn,a as wt,k as Ne,s as ve,_ as yn,n as ge}from"./main.js";import{p as yt,r as xt,s as st,_ as xn,a as Sn,b as kn}from"./op_select.js";import{_ as St}from"./index.js";import{_ as Mn}from"./Avatar.js";import{c as Cn,N as $n,_ as Ee}from"./Select.js";import{_ as kt}from"./Input.js";import{d as Fn,_ as Bn,a as En,b as Rn}from"./DropDown.js";import{_ as Pn}from"./TrashOutline.js";import{_ as An,a as On}from"./RadioGroup.js";import"./Tag.js";import"./get-slot.js";import"./VirtualList.js";import"./Forward.js";function Tn(e){return e.map(Mt)}function Mt(e){var t,n;return typeof e=="string"?{label:e,value:e}:e.type==="group"?{type:"group",label:(t=e.label)!==null&&t!==void 0?t:e.name,value:(n=e.value)!==null&&n!==void 0?n:e.name,key:e.key||e.name,children:e.children.map(s=>Mt(s))}:e}const Vn=Kt([Ye("auto-complete",`
 z-index: auto;
 position: relative;
 display: inline-flex;
 width: 100%;
 `),Ye("auto-complete-menu",`
 margin: 4px 0;
 box-shadow: var(--n-menu-box-shadow);
 `,[dn({originalTransition:"background-color .3s var(--n-bezier), box-shadow .3s var(--n-bezier)"})])]),Ln=Object.assign(Object.assign({},gt.props),{to:We.propTo,menuProps:Object,append:Boolean,bordered:{type:Boolean,default:void 0},clearable:{type:Boolean,default:void 0},defaultValue:{type:String,default:null},loading:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},placeholder:String,placement:{type:String,default:"bottom-start"},value:String,blurAfterSelect:Boolean,clearAfterSelect:Boolean,getShow:Function,showEmpty:Boolean,inputProps:Object,renderOption:Function,renderLabel:Function,size:String,options:{type:Array,default:()=>[]},zIndex:Number,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onSelect:[Function,Array],onBlur:[Function,Array],onFocus:[Function,Array],onInput:[Function,Array]}),Ct=Qt({name:"AutoComplete",props:Ln,setup(e){const{mergedBorderedRef:t,namespaceRef:n,mergedClsPrefixRef:r,inlineThemeDisabled:s}=Jt(e),i=Xt(e),{mergedSizeRef:o,mergedDisabledRef:f,mergedStatusRef:m}=i,$=D(null),k=D(null),C=D(e.defaultValue),x=Zt(e,"value"),I=Yt(x,C),h=D(!1),G=D(!1),w=gt("AutoComplete","-auto-complete",Vn,fn,e,r),F=L(()=>Tn(e.options)),N=L(()=>{const{getShow:g}=e;return g?g(I.value||""):!!I.value}),Y=L(()=>N.value&&h.value&&(e.showEmpty?!0:!!F.value.length)),ne=L(()=>pn(F.value,Cn("value","children")));function ee(g){const{"onUpdate:value":y,onUpdateValue:z,onInput:Z}=e,{nTriggerFormInput:ae,nTriggerFormChange:_}=i;z&&he(z,g),y&&he(y,g),Z&&he(Z,g),C.value=g,ae(),_()}function be(g){const{onSelect:y}=e,{nTriggerFormInput:z,nTriggerFormChange:Z}=i;y&&he(y,g),z(),Z()}function we(g){const{onBlur:y}=e,{nTriggerFormBlur:z}=i;y&&he(y,g),z()}function ye(g){const{onFocus:y}=e,{nTriggerFormFocus:z}=i;y&&he(y,g),z()}function W(){G.value=!0}function xe(){window.setTimeout(()=>{G.value=!1},0)}function B(g){var y,z,Z;switch(g.key){case"Enter":if(!G.value){const ae=(y=k.value)===null||y===void 0?void 0:y.getPendingTmNode();ae&&(ce(ae.rawNode),g.preventDefault())}break;case"ArrowDown":(z=k.value)===null||z===void 0||z.next();break;case"ArrowUp":(Z=k.value)===null||Z===void 0||Z.prev();break}}function ce(g){(g==null?void 0:g.value)!==void 0&&(be(g.value),e.clearAfterSelect?ee(null):g.label!==void 0&&ee(e.append?`${I.value}${g.label}`:g.label),h.value=!1,e.blurAfterSelect&&q())}function pe(){ee(null)}function Se(g){h.value=!0,ye(g)}function ke(g){h.value=!1,we(g)}function Me(g){h.value=!0,ee(g)}function Ce(g){ce(g.rawNode)}function $e(g){var y;!((y=$.value)===null||y===void 0)&&y.contains(rn(g))||(h.value=!1)}function q(){var g,y;!((g=$.value)===null||g===void 0)&&g.contains(document.activeElement)&&((y=document.activeElement)===null||y===void 0||y.blur())}const v=L(()=>{const{common:{cubicBezierEaseInOut:g},self:{menuBoxShadow:y}}=w.value;return{"--n-menu-box-shadow":y,"--n-bezier":g}}),c=s?en("auto-complete",void 0,v,e):void 0,S=D(null),X={focus:()=>{var g;(g=S.value)===null||g===void 0||g.focus()},blur:()=>{var g;(g=S.value)===null||g===void 0||g.blur()}};return{focus:X.focus,blur:X.blur,inputInstRef:S,uncontrolledValue:C,mergedValue:I,isMounted:tn(),adjustedTo:We(e),menuInstRef:k,triggerElRef:$,treeMate:ne,mergedSize:o,mergedDisabled:f,active:Y,mergedStatus:m,handleClear:pe,handleFocus:Se,handleBlur:ke,handleInput:Me,handleToggle:Ce,handleClickOutsideMenu:$e,handleCompositionStart:W,handleCompositionEnd:xe,handleKeyDown:B,mergedTheme:w,cssVars:s?void 0:v,themeClass:c==null?void 0:c.themeClass,onRender:c==null?void 0:c.onRender,mergedBordered:t,namespace:n,mergedClsPrefix:r}},render(){const{mergedClsPrefix:e}=this;return re("div",{class:`${e}-auto-complete`,ref:"triggerElRef",onKeydown:this.handleKeyDown,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd},re(mn,null,{default:()=>[re(hn,null,{default:()=>{if(this.$slots.default)return gn(this.$slots,"default",{handleInput:this.handleInput,handleFocus:this.handleFocus,handleBlur:this.handleBlur,value:this.mergedValue});const{mergedTheme:n}=this;return re(kt,{ref:"inputInstRef",status:this.mergedStatus,theme:n.peers.Input,themeOverrides:n.peerOverrides.Input,bordered:this.mergedBordered,value:this.mergedValue,placeholder:this.placeholder,size:this.mergedSize,disabled:this.mergedDisabled,clearable:this.clearable,loading:this.loading,inputProps:this.inputProps,onClear:this.handleClear,onFocus:this.handleFocus,onUpdateValue:this.handleInput,onBlur:this.handleBlur},{suffix:()=>{var r,s;return(s=(r=this.$slots).suffix)===null||s===void 0?void 0:s.call(r)},prefix:()=>{var r,s;return(s=(r=this.$slots).prefix)===null||s===void 0?void 0:s.call(r)}})}}),re(_n,{show:this.active,to:this.adjustedTo,containerClass:this.namespace,zIndex:this.zIndex,teleportDisabled:this.adjustedTo===We.tdkey,placement:this.placement,width:"target"},{default:()=>re(nn,{name:"fade-in-scale-up-transition",appear:this.isMounted},{default:()=>{var t;if((t=this.onRender)===null||t===void 0||t.call(this),!this.active)return null;const{menuProps:n}=this;return je(re($n,Object.assign({},n,{clsPrefix:e,ref:"menuInstRef",theme:this.mergedTheme.peers.InternalSelectMenu,themeOverrides:this.mergedTheme.peerOverrides.InternalSelectMenu,"auto-pending":!0,class:[`${e}-auto-complete-menu`,this.themeClass,n==null?void 0:n.class],style:[n==null?void 0:n.style,this.cssVars],treeMate:this.treeMate,multiple:!1,renderLabel:this.renderLabel,renderOption:this.renderOption,size:"medium",onToggle:this.handleToggle}),{empty:()=>{var r,s;return(s=(r=this.$slots).empty)===null||s===void 0?void 0:s.call(r)}}),[[vn,this.handleClickOutsideMenu,void 0,{capture:!0}]])}})})]}))}});function In(){const e=de(bn,null);return e===null&&_t("use-loading-bar","No outer <n-loading-bar-provider /> founded."),e}function Nn(){const e=de(wn,null);return e===null&&_t("use-message","No outer <n-message-provider /> founded. See prerequisite in https://www.naiveui.com/en-US/os-theme/components/message for more details. If you want to use `useMessage` outside setup, please check https://www.naiveui.com/zh-CN/os-theme/components/message#Q-&-A."),e}const J=e=>(Qe("data-v-61f3d7ff"),e=e(),Je(),e),Dn={class:"outer"},zn={class:"left_box"},Un={class:"left_contain"},jn=["onClick"],Wn=["onDragstart","onDrop"],qn={class:"facility-name"},Hn={class:"avatars"},Gn={key:0,class:"avatar-wrapper"},Kn=["src"],Qn={key:0,class:"workaholic"},Jn={class:"waiting"},Xn=J(()=>l("div",null,"待建造",-1)),Zn=[Xn],Yn={class:"mid_box"},er={class:"mid_contain"},tr=J(()=>l("div",{class:"facility-name"},"控制中枢",-1)),nr={class:"avatars"},rr=["src"],sr={class:"mid_contain"},or=J(()=>l("div",{class:"facility-name"},"宿舍1",-1)),ir={class:"avatars"},ar=["src"],lr={class:"mid_contain"},ur=J(()=>l("div",{class:"facility-name"},"宿舍2",-1)),cr={class:"avatars"},dr=["src"],fr={class:"mid_contain"},pr=J(()=>l("div",{class:"facility-name"},"宿舍3",-1)),mr={class:"avatars"},hr=["src"],gr={class:"mid_contain"},_r=J(()=>l("div",{class:"facility-name"},"宿舍4",-1)),vr={class:"avatars"},br=["src"],wr={class:"right_box"},yr={class:"right_contain"},xr=J(()=>l("div",{class:"facility-name"},"会客室",-1)),Sr={class:"avatars"},kr=["src"],Mr={class:"right_contain"},Cr=J(()=>l("div",{class:"facility-name"},"加工站",-1)),$r={class:"avatars"},Fr=["src"],Br={class:"right_contain"},Er=J(()=>l("div",{class:"facility-name"},"办公室",-1)),Rr={class:"avatars"},Pr=["src"],Ar={class:"right_contain"},Or=J(()=>l("div",{class:"facility-name"},[l("div",null,"协助位"),l("div",null,"训练位")],-1)),Tr={class:"avatars"},Vr=["src"],Lr=J(()=>l("td",null,"设施类别：",-1)),Ir={key:1,class:"type-select"},Nr={class:"select-label"},Dr={class:"table-space"},zr={class:"select-label"},Ur=J(()=>l("span",null,"组",-1)),jr={class:"table-space group"},Wr=J(()=>l("td",{class:"select-label"},"替换：",-1)),qr={__name:"PlanEditor",setup(e,{expose:t}){sn(v=>({"84ca658c":ce.value,"7898b81c":Ce.value}));const n=wt(),r=Ne(),{operators:s,groups:i,current_plan:o,workaholic:f,sub_plan:m,backup_plans:$}=ve(r),{facility_operator_limit:k}=r,{theme:C}=ve(n),x=D(null),I=[{label:"贸易站",value:"贸易站"},{label:"制造站",value:"制造站"},{label:"发电站",value:"发电站"}],h=de("facility"),G={贸易站:"info",制造站:"warning",发电站:"primary"},w=L(()=>h.value.startsWith("room")&&o.value[h.value].name=="发电站"?1:k[h.value]||0);function F(){o.value[h.value].name="",an(()=>{const v=[];for(let c=0;c<w.value;++c)v.push({agent:"",group:"",replacement:[]});o.value[h.value].plans=v})}Ke(()=>h.value.startsWith("room")?o.value[h.value].name:"",(v,c)=>{if(v=="发电站"){const S=o.value[h.value].plans;for(;S.length>w.value;)S.pop()}else if(c=="发电站"){const S=o.value[h.value].plans;for(;S.length<w.value;)S.push({agent:"",group:"",replacement:[]})}});const N=L(()=>[{value:"",label:"（无）"}].concat(s.value));L(()=>[{value:"Free",label:"Free"}].concat(s.value));const Y=L(()=>[{value:"Free",label:"Free"}].concat(N.value)),ne=L(()=>[{value:"Current",label:"Current"}].concat(N.value)),ee=L(()=>[{value:"Current",label:"Current"}].concat(Y.value));function be(v){return m.value=="main"?v.startsWith("dorm")?Y.value:N.value:v.startsWith("dorm")?ee.value:ne.value}const we=L(()=>h.value.startsWith("dormitory")?"宿舍":h.value=="central"?"控制中枢":h.value=="contact"?"办公室":h.value=="meeting"?"会客室":h.value=="factory"?"加工站":h.value=="train"?"训练室（仅可安排协助位）":"未知"),ye=L(()=>{let v=!0;for(const c of o.value[h.value].plans)if(c.agent){v=!1;break}return v}),W=L(()=>{const v=i.value.length,c={};for(let S=0;S<v;++S)c[i.value[S]]=`5px solid hsl(${360/v*S}, 80%, 45%)`;return c[""]="none",c});function xe(v,c){c.dataTransfer.setData("text/plain",v),c.dataTransfer.dropEffect="move"}function B(v,c){const S=c.dataTransfer.getData("text/plain");st(S,v,o.value),m.value=="main"&&$.value.forEach(X=>{st(S,v,X.plan)}),c.preventDefault()}const ce=L(()=>C.value=="light"?"lightgrey":"grey");t({outer:x});function pe(){for(let v=0;v<w.value;++v)o.value[h.value].plans[v].agent==""&&(o.value[h.value].plans[v].agent="Free")}const Se=[{label:"赤金订单",value:"lmd"},{label:"合成玉订单",value:"orundum"}],ke=[{label:"赤金",value:"gold"},{label:"中级作战记录",value:"exp3"},{label:"源石碎片",value:"orirock"}],Me=v=>re("div",{style:{display:"flex",alignItems:"center",gap:"12px"}},[re(Mn,{src:"/product/"+v.value+".png",round:!0,size:"small"}),v.label]),Ce=L(()=>C.value=="light"?.6:.7),$e=L(()=>{for(let v=1;v<=4;++v)for(let c=0;c<5;++c)if(o.value[`dormitory_${v}`].plans[c].agent=="菲亚梅塔")return o.value[`dormitory_${v}`].plans[c].replacement;return[]});function q(v){h.value==v?h.value="":h.value=v}return(v,c)=>{const S=vt,X=Ee,g=He,y=St,z=kt,Z=mt,ae=ht;return b(),M("div",{class:"plan-container",ref_key:"outer",ref:x},[l("div",Dn,[l("div",zn,[(b(),M(V,null,K(3,_=>l("div",Un,[(b(!0),M(V,null,K([`room_${_}_1`,`room_${_}_2`,`room_${_}_3`],P=>(b(),M("div",{key:P,onClick:A=>q(P),class:on([G[u(o)[P].name],P===u(h)?"true":"false"])},[["制造站","贸易站"].includes(u(o)[P].name)?(b(),M("div",{key:0,class:"product-bg",style:te({"background-image":`url(/product/${u(o)[P].product}.png)`})},null,4)):se("",!0),je(l("div",{draggable:"true",onDragstart:A=>xe(P,A),onDragover:c[0]||(c[0]=tt(()=>{},["prevent"])),onDragenter:c[1]||(c[1]=tt(()=>{},["prevent"])),onDrop:A=>B(P,A),class:"draggable"},[l("div",qn,nt(u(o)[P].name),1),l("div",Hn,[(b(!0),M(V,null,K(u(o)[P].plans,A=>(b(),M(V,null,[A.agent?(b(),M("div",Gn,[l("img",{src:`avatar/${A.agent}.webp`,width:"45",height:"45",style:te({"border-bottom":W.value[A.group]}),draggable:"false"},null,12,Kn),u(f).includes(A.agent)&&!$e.value.includes(A.agent)?(b(),M("div",Qn)):se("",!0)])):se("",!0)],64))),256))])],40,Wn),[[et,u(o)[P].name]]),je(l("div",Jn,Zn,512),[[et,!u(o)[P].name]])],10,jn))),128))])),64))]),l("div",Yn,[l("div",er,[d(S,{secondary:u(h)!="central",class:"facility-5",onClick:c[2]||(c[2]=_=>q("central"))},{default:p(()=>[l("div",null,[tr,l("div",nr,[(b(!0),M(V,null,K(u(o).central.plans,_=>(b(),M("img",{src:`avatar/${_.agent}.webp`,width:"45",height:"45",style:te({"border-bottom":W.value[_.group]})},null,12,rr))),256))])])]),_:1},8,["secondary"])]),l("div",sr,[d(S,{secondary:u(h)!="dormitory_1",class:"facility-5",onClick:c[3]||(c[3]=_=>q("dormitory_1"))},{default:p(()=>[l("div",null,[or,l("div",ir,[(b(!0),M(V,null,K(u(o).dormitory_1.plans,_=>(b(),M("img",{src:`avatar/${_.agent}.webp`,width:"45",height:"45",style:te({"border-bottom":W.value[_.group]})},null,12,ar))),256))])])]),_:1},8,["secondary"])]),l("div",lr,[d(S,{secondary:u(h)!="dormitory_2",class:"facility-5",onClick:c[4]||(c[4]=_=>q("dormitory_2"))},{default:p(()=>[l("div",null,[ur,l("div",cr,[(b(!0),M(V,null,K(u(o).dormitory_2.plans,_=>(b(),M("img",{src:`avatar/${_.agent}.webp`,width:"45",height:"45",style:te({"border-bottom":W.value[_.group]})},null,12,dr))),256))])])]),_:1},8,["secondary"])]),l("div",fr,[d(S,{secondary:u(h)!="dormitory_3",class:"facility-5",onClick:c[5]||(c[5]=_=>q("dormitory_3"))},{default:p(()=>[l("div",null,[pr,l("div",mr,[(b(!0),M(V,null,K(u(o).dormitory_3.plans,_=>(b(),M("img",{src:`avatar/${_.agent}.webp`,width:"45",height:"45",style:te({"border-bottom":W.value[_.group]})},null,12,hr))),256))])])]),_:1},8,["secondary"])]),l("div",gr,[d(S,{secondary:u(h)!="dormitory_4",class:"facility-5",onClick:c[6]||(c[6]=_=>q("dormitory_4"))},{default:p(()=>[l("div",null,[_r,l("div",vr,[(b(!0),M(V,null,K(u(o).dormitory_4.plans,_=>(b(),M("img",{src:`avatar/${_.agent}.webp`,width:"45",height:"45",style:te({"border-bottom":W.value[_.group]})},null,12,br))),256))])])]),_:1},8,["secondary"])])]),l("div",wr,[l("div",yr,[d(S,{secondary:u(h)!="meeting",class:"facility-2",onClick:c[7]||(c[7]=_=>q("meeting"))},{default:p(()=>[l("div",null,[xr,l("div",Sr,[(b(!0),M(V,null,K(u(o).meeting.plans,_=>(b(),M("img",{src:`avatar/${_.agent}.webp`,width:"45",height:"45",style:te({"border-bottom":W.value[_.group]})},null,12,kr))),256))])])]),_:1},8,["secondary"])]),l("div",Mr,[d(S,{secondary:u(h)!="factory",class:"facility-2",onClick:c[8]||(c[8]=_=>q("factory"))},{default:p(()=>[l("div",null,[Cr,l("div",$r,[(b(!0),M(V,null,K(u(o).factory.plans,_=>(b(),M("img",{src:`avatar/${_.agent}.webp`,width:"45",height:"45",style:te({"border-bottom":W.value[_.group]})},null,12,Fr))),256))])])]),_:1},8,["secondary"])]),l("div",Br,[d(S,{secondary:u(h)!="contact",class:"facility-2",onClick:c[9]||(c[9]=_=>q("contact"))},{default:p(()=>[l("div",null,[Er,l("div",Rr,[(b(!0),M(V,null,K(u(o).contact.plans,_=>(b(),M("img",{src:`avatar/${_.agent}.webp`,width:"45",height:"45",style:te({"border-bottom":W.value[_.group]})},null,12,Pr))),256))])])]),_:1},8,["secondary"])]),l("div",Ar,[d(S,{secondary:u(h)!="train",class:"facility-2",onClick:c[10]||(c[10]=_=>q("train"))},{default:p(()=>[l("div",null,[Or,l("div",Tr,[(b(!0),M(V,null,K(u(o).train.plans,_=>(b(),M("img",{src:`avatar/${_.agent}.webp`,width:"45",height:"45",style:te({"border-bottom":W.value[_.group]})},null,12,Vr))),256))])])]),_:1},8,["secondary"])])])]),u(h)?(b(),oe(y,{key:0,justify:"center"},{default:p(()=>[l("table",null,[l("tr",null,[Lr,l("td",null,[u(h).startsWith("room")?(b(),oe(X,{key:0,value:u(o)[u(h)].name,"onUpdate:value":c[11]||(c[11]=_=>u(o)[u(h)].name=_),options:I,class:"type-select"},null,8,["value"])):(b(),M("span",Ir,nt(we.value),1))]),["制造站","贸易站"].includes(u(o)[u(h)].name)?(b(),M(V,{key:0},[l("td",null,[E("产物"),d(g,null,{default:p(()=>[E("切产物功能暂未实装")]),_:1})]),l("td",null,[d(X,{value:u(o)[u(h)].product,"onUpdate:value":c[12]||(c[12]=_=>u(o)[u(h)].product=_),options:u(o)[u(h)].name=="制造站"?ke:Se,class:"product-select","render-label":Me},null,8,["value","options"])])],64)):se("",!0),l("td",null,[u(h).startsWith("dorm")?(b(),oe(S,{key:0,ghost:"",type:"primary",onClick:pe},{default:p(()=>[E(" 此宿舍内空位填充Free ")]),_:1})):se("",!0)]),l("td",null,[d(S,{ghost:"",type:"error",onClick:F,disabled:ye.value},{default:p(()=>[E(" 清空此设施内干员 ")]),_:1},8,["disabled"])])])])]),_:1})):se("",!0),d(y,{justify:"center"},{default:p(()=>[l("table",null,[(b(!0),M(V,null,K(w.value,_=>(b(),M("tr",{key:_},[l("td",Nr,[u(h)=="train"&&_==1?(b(),M(V,{key:0},[E("协助位")],64)):u(h)=="train"&&_==2?(b(),M(V,{key:1},[E("训练位")],64)):(b(),M(V,{key:2},[E("干员：")],64))]),l("td",Dr,[d(X,{filterable:"",options:be(u(h)),class:"operator-select",value:u(o)[u(h)].plans[_-1].agent,"onUpdate:value":P=>u(o)[u(h)].plans[_-1].agent=P,filter:(P,A)=>u(yt)(A.label,P),"render-label":u(xt)},null,8,["options","value","onUpdate:value","filter","render-label"])]),l("td",zr,[Ur,d(g,null,{default:p(()=>[E("可以将有联动基建技能的干员或者心情掉率相等的干员编入同组")]),_:1})]),l("td",jr,[d(z,{value:u(o)[u(h)].plans[_-1].group,"onUpdate:value":P=>u(o)[u(h)].plans[_-1].group=P,disabled:!u(o)[u(h)].plans[_-1].agent},null,8,["value","onUpdate:value","disabled"])]),Wr,l("td",null,[d(ae,{"show-label":!1,"show-feedback":!1},{default:p(()=>[d(Z,{disabled:!u(o)[u(h)].plans[_-1].agent,modelValue:u(o)[u(h)].plans[_-1].replacement,"onUpdate:modelValue":P=>u(o)[u(h)].plans[_-1].replacement=P,class:"replacement-select"},null,8,["disabled","modelValue","onUpdate:modelValue"])]),_:2},1024)])]))),128))])]),_:1})],512)}}},Hr=Ge(qr,[["__scopeId","data-v-61f3d7ff"]]),Gr={__name:"TriggerString",props:["data"],emits:["update"],setup(e,{emit:t}){const n=e,r=t,s=D(n.data);Ke(s,()=>{r("update",s.value)});const i=L(()=>{let w=s.value.match(/op_data.operators\['(.+?)'\].is_resting\(\)/);return w&&w[0]==s.value?{type:"in_dorm",operator:w[1]}:(w=s.value.match(/op_data.operators\['(.+?)'\].is_working\(\)/),w&&w[0]==s.value?{type:"working",operator:w[1]}:(w=s.value.match(/op_data.operators\['(.+?)'\].current_room/),w&&w[0]==s.value?{type:"room",operator:w[1]}:(w=s.value.match(/op_data.operators\['(.+?)'\].current_mood\(\)/),w&&w[0]==s.value?{type:"mood",operator:w[1]}:s.value=="op_data.party_time"?{type:"impart"}:{type:"custom"})))}),o=L(()=>i.value.type=="custom"?"custom":i.value.type=="impart"?"impart":"op"),f=[{label:"干员属性",value:"op"},{label:"线索交流结束时间",value:"impart"},{label:"自定义",value:"custom"}],m=[{label:"心情",value:"mood"},{label:"当前位置",value:"room"},{label:"在工作",value:"working"},{label:"在休息",value:"in_dorm"}];function $(w){s.value="",w=="op"?s.value="op_data.operators['阿米娅'].current_mood()":w=="impart"&&(s.value="op_data.party_time")}const k=Ne(),{operators:C}=ve(k);function x(w,F){const N=`op_data.operators['${w}'].`;F=="in_dorm"?s.value=N+"is_resting()":F=="working"?s.value=N+"is_working()":F=="room"?s.value=N+"current_room":F=="mood"?s.value=N+"current_mood()":s.value=""}function I(w){x(w,i.value.type)}function h(w){x(i.value.operator,w)}const G=["True","False","None"];return(w,F)=>{const N=Ee,Y=Ct;return b(),M(V,null,[d(N,{"default-value":o.value,options:f,"on-update:value":$,style:{"min-width":"180px"}},null,8,["default-value"]),o.value=="custom"?(b(),oe(Y,{key:0,value:s.value,"onUpdate:value":F[0]||(F[0]=ne=>s.value=ne),options:G,"blur-after-select":"","get-show":()=>!0},null,8,["value"])):se("",!0),o.value=="op"?(b(),M(V,{key:1},[d(N,{"default-value":i.value.operator,filterable:"",options:u(C),"on-update:value":I,filter:(ne,ee)=>u(yt)(ee.label,ne),"render-label":u(xt),style:{"min-width":"220px"}},null,8,["default-value","options","filter","render-label"]),d(N,{"default-value":i.value.type,options:m,"on-update:value":h,style:{"min-width":"120px"}},null,8,["default-value"])],64)):se("",!0)],64)}}},Kr=e=>(Qe("data-v-37669413"),e=e(),Je(),e),Qr={class:"label"},Jr={key:1,class:"label"},Xr=Kr(()=>l("th",null,"运算符",-1)),Zr={class:"label"},Yr={key:1,class:"label"},es={__name:"TriggerEditor",props:["data"],emits:["update"],setup(e,{emit:t}){const n=e,r=t,s=D(n.data.left),i=D(n.data.operator),o=D(n.data.right);function f(){const k={left:s.value,operator:i.value,right:o.value};r("update",k)}Ke([s,i,o],()=>{f()});const m=[{label:"表达式",value:"expression"},{label:"值",value:"string"}],$=["and","or","==","!=",">","<",">=","<=","+","-"];return(k,C)=>{const x=Ee,I=ln("trigger-editor",!0),h=Gr,G=Ct,w=xn;return b(),oe(w,{size:"small","single-line":!1},{default:p(()=>[l("tr",null,[l("th",null,[l("div",Qr,[E(" 左 "),d(x,{"default-value":typeof s.value=="object"?"expression":"string","on-update:value":F=>{s.value=F=="string"?"":{left:"",operator:"",right:""}},options:m},null,8,["default-value","on-update:value"])])]),l("td",null,[typeof s.value=="object"?(b(),oe(I,{key:0,data:s.value,onUpdate:C[0]||(C[0]=F=>s.value=F)},null,8,["data"])):(b(),M("div",Jr,[d(h,{data:s.value,onUpdate:C[1]||(C[1]=F=>{s.value=F})},null,8,["data"])]))])]),l("tr",null,[Xr,l("td",null,[d(G,{value:i.value,"onUpdate:value":C[2]||(C[2]=F=>i.value=F),options:$,"blur-after-select":"","get-show":()=>!0},null,8,["value"])])]),l("tr",null,[l("th",null,[l("div",Zr,[E(" 右 "),d(x,{"default-value":typeof o.value=="object"?"expression":"string","on-update:value":F=>{o.value=F=="string"?"":{left:"",operator:"",right:""}},options:m},null,8,["default-value","on-update:value"])])]),l("td",null,[typeof o.value=="object"?(b(),oe(I,{key:0,data:o.value,onUpdate:C[3]||(C[3]=F=>o.value=F)},null,8,["data"])):(b(),M("div",Yr,[d(h,{data:o.value,onUpdate:C[4]||(C[4]=F=>{o.value=F})},null,8,["data"])]))])])]),_:1})}}},ts=Ge(es,[["__scopeId","data-v-37669413"]]),ns={class:"dropdown-container"},rs={class:"dropdown-label"},ss=l("div",null,"任务开始：单个任务开始时",-1),os=l("div",null,"下班结束：高效组下班任务安排完毕，生成上班时间任务前",-1),is=l("div",null,"上班结束：高效组上班安排结束时",-1),as=l("div",null,"任务结束：单个任务结束时",-1),ls={__name:"TriggerDialog",setup(e){const t=de("show_trigger_editor"),n=Ne(),{sub_plan:r,backup_plans:s}=ve(n),i=[{label:"任务开始",value:"BEGINNING"},{label:"下班结束",value:"BEFORE_PLANNING"},{label:"上班结束",value:"AFTER_PLANNING"},{label:"任务结束",value:"END"}];function o(f){s.value[r.value].trigger=f}return(f,m)=>{const $=He,k=Ee,C=ts,x=Fn,I=Bn,h=un,G=yn;return b(),oe(G,{show:u(t),"onUpdate:show":m[1]||(m[1]=w=>bt(t)?t.value=w:null),preset:"card",title:"触发条件","transform-origin":"center",style:{width:"auto","max-width":"90vw"}},{default:p(()=>[l("div",ns,[l("label",rs,[E("触发时机 "),d($,null,{default:p(()=>[ss,os,is,as]),_:1})]),d(k,{value:u(s)[u(r)].trigger_timing,"onUpdate:value":m[0]||(m[0]=w=>u(s)[u(r)].trigger_timing=w),options:i,placeholder:"Select Trigger Timing",class:"dropdown-select"},null,8,["value"])]),d(x,{style:{"max-height":"80vh","margin-top":"5px"}},{default:p(()=>[d(x,{"x-scrollable":""},{default:p(()=>[d(C,{data:u(s)[u(r)].trigger,onUpdate:o},null,8,["data"])]),_:1}),d(h,{style:{"margin-top":"8px"},"content-style":"padding: 8px",embedded:""},{default:p(()=>[d(I,{code:JSON.stringify(u(s)[u(r)].trigger,null,2),language:"json","word-wrap":""},null,8,["code"])]),_:1})]),_:1})]),_:1},8,["show"])}}};function us(e){return new Promise(t=>setTimeout(t,e))}function cs(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const n=document.implementation.createHTMLDocument(),r=n.createElement("base"),s=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(s),t&&(r.href=t),s.href=e,s.href}const ds=(()=>{let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function ie(e){const t=[];for(let n=0,r=e.length;n<r;n++)t.push(e[n]);return t}function Le(e,t){const r=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return r?parseFloat(r.replace("px","")):0}function fs(e){const t=Le(e,"border-left-width"),n=Le(e,"border-right-width");return e.clientWidth+t+n}function ps(e){const t=Le(e,"border-top-width"),n=Le(e,"border-bottom-width");return e.clientHeight+t+n}function $t(e,t={}){const n=t.width||fs(e),r=t.height||ps(e);return{width:n,height:r}}function ms(){let e,t;try{t=process}catch{}const n=t&&t.env?t.env.devicePixelRatio:null;return n&&(e=parseInt(n,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const Q=16384;function hs(e){(e.width>Q||e.height>Q)&&(e.width>Q&&e.height>Q?e.width>e.height?(e.height*=Q/e.width,e.width=Q):(e.width*=Q/e.height,e.height=Q):e.width>Q?(e.height*=Q/e.width,e.width=Q):(e.width*=Q/e.height,e.height=Q))}function gs(e,t={}){return e.toBlob?new Promise(n=>{e.toBlob(n,t.type?t.type:"image/png",t.quality?t.quality:1)}):new Promise(n=>{const r=window.atob(e.toDataURL(t.type?t.type:void 0,t.quality?t.quality:void 0).split(",")[1]),s=r.length,i=new Uint8Array(s);for(let o=0;o<s;o+=1)i[o]=r.charCodeAt(o);n(new Blob([i],{type:t.type?t.type:"image/png"}))})}function Ie(e){return new Promise((t,n)=>{const r=new Image;r.decode=()=>t(r),r.onload=()=>t(r),r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=e})}async function _s(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function vs(e,t,n){const r="http://www.w3.org/2000/svg",s=document.createElementNS(r,"svg"),i=document.createElementNS(r,"foreignObject");return s.setAttribute("width",`${t}`),s.setAttribute("height",`${n}`),s.setAttribute("viewBox",`0 0 ${t} ${n}`),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("externalResourcesRequired","true"),s.appendChild(i),i.appendChild(e),_s(s)}const H=(e,t)=>{if(e instanceof t)return!0;const n=Object.getPrototypeOf(e);return n===null?!1:n.constructor.name===t.name||H(n,t)};function bs(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function ws(e){return ie(e).map(t=>{const n=e.getPropertyValue(t),r=e.getPropertyPriority(t);return`${t}: ${n}${r?" !important":""};`}).join(" ")}function ys(e,t,n){const r=`.${e}:${t}`,s=n.cssText?bs(n):ws(n);return document.createTextNode(`${r}{${s}}`)}function ot(e,t,n){const r=window.getComputedStyle(e,n),s=r.getPropertyValue("content");if(s===""||s==="none")return;const i=ds();try{t.className=`${t.className} ${i}`}catch{return}const o=document.createElement("style");o.appendChild(ys(i,n,r)),t.appendChild(o)}function xs(e,t){ot(e,t,":before"),ot(e,t,":after")}const it="application/font-woff",at="image/jpeg",Ss={woff:it,woff2:it,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:at,jpeg:at,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function ks(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function Xe(e){const t=ks(e).toLowerCase();return Ss[t]||""}function Ms(e){return e.split(/,/)[1]}function qe(e){return e.search(/^(data:)/)!==-1}function Ft(e,t){return`data:${t};base64,${e}`}async function Bt(e,t,n){const r=await fetch(e,t);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const s=await r.blob();return new Promise((i,o)=>{const f=new FileReader;f.onerror=o,f.onloadend=()=>{try{i(n({res:r,result:f.result}))}catch(m){o(m)}},f.readAsDataURL(s)})}const Ue={};function Cs(e,t,n){let r=e.replace(/\?.*/,"");return n&&(r=e),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),t?`[${t}]${r}`:r}async function Ze(e,t,n){const r=Cs(e,t,n.includeQueryParams);if(Ue[r]!=null)return Ue[r];n.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let s;try{const i=await Bt(e,n.fetchRequestInit,({res:o,result:f})=>(t||(t=o.headers.get("Content-Type")||""),Ms(f)));s=Ft(i,t)}catch(i){s=n.imagePlaceholder||"";let o=`Failed to fetch resource: ${e}`;i&&(o=typeof i=="string"?i:i.message),o&&console.warn(o)}return Ue[r]=s,s}async function $s(e){const t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):Ie(t)}async function Fs(e,t){if(e.currentSrc){const i=document.createElement("canvas"),o=i.getContext("2d");i.width=e.clientWidth,i.height=e.clientHeight,o==null||o.drawImage(e,0,0,i.width,i.height);const f=i.toDataURL();return Ie(f)}const n=e.poster,r=Xe(n),s=await Ze(n,r,t);return Ie(s)}async function Bs(e){var t;try{if(!((t=e==null?void 0:e.contentDocument)===null||t===void 0)&&t.body)return await De(e.contentDocument.body,{},!0)}catch{}return e.cloneNode(!1)}async function Es(e,t){return H(e,HTMLCanvasElement)?$s(e):H(e,HTMLVideoElement)?Fs(e,t):H(e,HTMLIFrameElement)?Bs(e):e.cloneNode(!1)}const Rs=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT";async function Ps(e,t,n){var r,s;let i=[];return Rs(e)&&e.assignedNodes?i=ie(e.assignedNodes()):H(e,HTMLIFrameElement)&&(!((r=e.contentDocument)===null||r===void 0)&&r.body)?i=ie(e.contentDocument.body.childNodes):i=ie(((s=e.shadowRoot)!==null&&s!==void 0?s:e).childNodes),i.length===0||H(e,HTMLVideoElement)||await i.reduce((o,f)=>o.then(()=>De(f,n)).then(m=>{m&&t.appendChild(m)}),Promise.resolve()),t}function As(e,t){const n=t.style;if(!n)return;const r=window.getComputedStyle(e);r.cssText?(n.cssText=r.cssText,n.transformOrigin=r.transformOrigin):ie(r).forEach(s=>{let i=r.getPropertyValue(s);s==="font-size"&&i.endsWith("px")&&(i=`${Math.floor(parseFloat(i.substring(0,i.length-2)))-.1}px`),H(e,HTMLIFrameElement)&&s==="display"&&i==="inline"&&(i="block"),s==="d"&&t.getAttribute("d")&&(i=`path(${t.getAttribute("d")})`),n.setProperty(s,i,r.getPropertyPriority(s))})}function Os(e,t){H(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),H(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function Ts(e,t){if(H(e,HTMLSelectElement)){const n=t,r=Array.from(n.children).find(s=>e.value===s.getAttribute("value"));r&&r.setAttribute("selected","")}}function Vs(e,t){return H(t,Element)&&(As(e,t),xs(e,t),Os(e,t),Ts(e,t)),t}async function Ls(e,t){const n=e.querySelectorAll?e.querySelectorAll("use"):[];if(n.length===0)return e;const r={};for(let i=0;i<n.length;i++){const f=n[i].getAttribute("xlink:href");if(f){const m=e.querySelector(f),$=document.querySelector(f);!m&&$&&!r[f]&&(r[f]=await De($,t,!0))}}const s=Object.values(r);if(s.length){const i="http://www.w3.org/1999/xhtml",o=document.createElementNS(i,"svg");o.setAttribute("xmlns",i),o.style.position="absolute",o.style.width="0",o.style.height="0",o.style.overflow="hidden",o.style.display="none";const f=document.createElementNS(i,"defs");o.appendChild(f);for(let m=0;m<s.length;m++)f.appendChild(s[m]);e.appendChild(o)}return e}async function De(e,t,n){return!n&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(r=>Es(r,t)).then(r=>Ps(e,r,t)).then(r=>Vs(e,r)).then(r=>Ls(r,t))}const Et=/url\((['"]?)([^'"]+?)\1\)/g,Is=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,Ns=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function Ds(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function zs(e){const t=[];return e.replace(Et,(n,r,s)=>(t.push(s),n)),t.filter(n=>!qe(n))}async function Us(e,t,n,r,s){try{const i=n?cs(t,n):t,o=Xe(t);let f;if(s){const m=await s(i);f=Ft(m,o)}else f=await Ze(i,o,r);return e.replace(Ds(t),`$1${f}$3`)}catch{}return e}function js(e,{preferredFontFormat:t}){return t?e.replace(Ns,n=>{for(;;){const[r,,s]=Is.exec(n)||[];if(!s)return"";if(s===t)return`src: ${r};`}}):e}function Rt(e){return e.search(Et)!==-1}async function Pt(e,t,n){if(!Rt(e))return e;const r=js(e,n);return zs(r).reduce((i,o)=>i.then(f=>Us(f,o,t,n)),Promise.resolve(r))}async function Pe(e,t,n){var r;const s=(r=t.style)===null||r===void 0?void 0:r.getPropertyValue(e);if(s){const i=await Pt(s,null,n);return t.style.setProperty(e,i,t.style.getPropertyPriority(e)),!0}return!1}async function Ws(e,t){await Pe("background",e,t)||await Pe("background-image",e,t),await Pe("mask",e,t)||await Pe("mask-image",e,t)}async function qs(e,t){const n=H(e,HTMLImageElement);if(!(n&&!qe(e.src))&&!(H(e,SVGImageElement)&&!qe(e.href.baseVal)))return;const r=n?e.src:e.href.baseVal,s=await Ze(r,Xe(r),t);await new Promise((i,o)=>{e.onload=i,e.onerror=o;const f=e;f.decode&&(f.decode=i),f.loading==="lazy"&&(f.loading="eager"),n?(e.srcset="",e.src=s):e.href.baseVal=s})}async function Hs(e,t){const r=ie(e.childNodes).map(s=>At(s,t));await Promise.all(r).then(()=>e)}async function At(e,t){H(e,Element)&&(await Ws(e,t),await qs(e,t),await Hs(e,t))}function Gs(e,t){const{style:n}=e;t.backgroundColor&&(n.backgroundColor=t.backgroundColor),t.width&&(n.width=`${t.width}px`),t.height&&(n.height=`${t.height}px`);const r=t.style;return r!=null&&Object.keys(r).forEach(s=>{n[s]=r[s]}),e}const lt={};async function ut(e){let t=lt[e];if(t!=null)return t;const r=await(await fetch(e)).text();return t={url:e,cssText:r},lt[e]=t,t}async function ct(e,t){let n=e.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,i=(n.match(/url\([^)]+\)/g)||[]).map(async o=>{let f=o.replace(r,"$1");return f.startsWith("https://")||(f=new URL(f,e.url).href),Bt(f,t.fetchRequestInit,({result:m})=>(n=n.replace(o,`url(${m})`),[o,m]))});return Promise.all(i).then(()=>n)}function dt(e){if(e==null)return[];const t=[],n=/(\/\*[\s\S]*?\*\/)/gi;let r=e.replace(n,"");const s=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const m=s.exec(r);if(m===null)break;t.push(m[0])}r=r.replace(s,"");const i=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,o="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",f=new RegExp(o,"gi");for(;;){let m=i.exec(r);if(m===null){if(m=f.exec(r),m===null)break;i.lastIndex=f.lastIndex}else f.lastIndex=i.lastIndex;t.push(m[0])}return t}async function Ks(e,t){const n=[],r=[];return e.forEach(s=>{if("cssRules"in s)try{ie(s.cssRules||[]).forEach((i,o)=>{if(i.type===CSSRule.IMPORT_RULE){let f=o+1;const m=i.href,$=ut(m).then(k=>ct(k,t)).then(k=>dt(k).forEach(C=>{try{s.insertRule(C,C.startsWith("@import")?f+=1:s.cssRules.length)}catch(x){console.error("Error inserting rule from remote css",{rule:C,error:x})}})).catch(k=>{console.error("Error loading remote css",k.toString())});r.push($)}})}catch(i){const o=e.find(f=>f.href==null)||document.styleSheets[0];s.href!=null&&r.push(ut(s.href).then(f=>ct(f,t)).then(f=>dt(f).forEach(m=>{o.insertRule(m,s.cssRules.length)})).catch(f=>{console.error("Error loading remote stylesheet",f)})),console.error("Error inlining remote css file",i)}}),Promise.all(r).then(()=>(e.forEach(s=>{if("cssRules"in s)try{ie(s.cssRules||[]).forEach(i=>{n.push(i)})}catch(i){console.error(`Error while reading CSS rules from ${s.href}`,i)}}),n))}function Qs(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>Rt(t.style.getPropertyValue("src")))}async function Js(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const n=ie(e.ownerDocument.styleSheets),r=await Ks(n,t);return Qs(r)}async function Xs(e,t){const n=await Js(e,t);return(await Promise.all(n.map(s=>{const i=s.parentStyleSheet?s.parentStyleSheet.href:null;return Pt(s.cssText,i,t)}))).join(`
`)}async function Zs(e,t){const n=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await Xs(e,t);if(n){const r=document.createElement("style"),s=document.createTextNode(n);r.appendChild(s),e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}}async function Ys(e,t={}){const{width:n,height:r}=$t(e,t),s=await De(e,t,!0);return await Zs(s,t),await At(s,t),Gs(s,t),await vs(s,n,r)}async function eo(e,t={}){const{width:n,height:r}=$t(e,t),s=await Ys(e,t),i=await Ie(s),o=document.createElement("canvas"),f=o.getContext("2d"),m=t.pixelRatio||ms(),$=t.canvasWidth||n,k=t.canvasHeight||r;return o.width=$*m,o.height=k*m,t.skipAutoScale||hs(o),o.style.width=`${$}`,o.style.height=`${k}`,t.backgroundColor&&(f.fillStyle=t.backgroundColor,f.fillRect(0,0,o.width,o.height)),f.drawImage(i,0,0,o.width,o.height),o}async function ft(e,t={}){const n=await eo(e,t);return await gs(n)}const to={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},Ot={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},T={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},U={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},ue={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class a{static getFirstMatch(t,n){const r=n.match(t);return r&&r.length>0&&r[1]||""}static getSecondMatch(t,n){const r=n.match(t);return r&&r.length>1&&r[2]||""}static matchAndReturnConst(t,n,r){if(t.test(n))return r}static getWindowsVersionName(t){switch(t){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(t){const n=t.split(".").splice(0,2).map(r=>parseInt(r,10)||0);if(n.push(0),n[0]===10)switch(n[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(t){const n=t.split(".").splice(0,2).map(r=>parseInt(r,10)||0);if(n.push(0),!(n[0]===1&&n[1]<5)){if(n[0]===1&&n[1]<6)return"Cupcake";if(n[0]===1&&n[1]>=6)return"Donut";if(n[0]===2&&n[1]<2)return"Eclair";if(n[0]===2&&n[1]===2)return"Froyo";if(n[0]===2&&n[1]>2)return"Gingerbread";if(n[0]===3)return"Honeycomb";if(n[0]===4&&n[1]<1)return"Ice Cream Sandwich";if(n[0]===4&&n[1]<4)return"Jelly Bean";if(n[0]===4&&n[1]>=4)return"KitKat";if(n[0]===5)return"Lollipop";if(n[0]===6)return"Marshmallow";if(n[0]===7)return"Nougat";if(n[0]===8)return"Oreo";if(n[0]===9)return"Pie"}}static getVersionPrecision(t){return t.split(".").length}static compareVersions(t,n,r=!1){const s=a.getVersionPrecision(t),i=a.getVersionPrecision(n);let o=Math.max(s,i),f=0;const m=a.map([t,n],$=>{const k=o-a.getVersionPrecision($),C=$+new Array(k+1).join(".0");return a.map(C.split("."),x=>new Array(20-x.length).join("0")+x).reverse()});for(r&&(f=o-Math.min(s,i)),o-=1;o>=f;){if(m[0][o]>m[1][o])return 1;if(m[0][o]===m[1][o]){if(o===f)return 0;o-=1}else if(m[0][o]<m[1][o])return-1}}static map(t,n){const r=[];let s;if(Array.prototype.map)return Array.prototype.map.call(t,n);for(s=0;s<t.length;s+=1)r.push(n(t[s]));return r}static find(t,n){let r,s;if(Array.prototype.find)return Array.prototype.find.call(t,n);for(r=0,s=t.length;r<s;r+=1){const i=t[r];if(n(i,r))return i}}static assign(t,...n){const r=t;let s,i;if(Object.assign)return Object.assign(t,...n);for(s=0,i=n.length;s<i;s+=1){const o=n[s];typeof o=="object"&&o!==null&&Object.keys(o).forEach(m=>{r[m]=o[m]})}return t}static getBrowserAlias(t){return to[t]}static getBrowserTypeByAlias(t){return Ot[t]||""}}const R=/version\/(\d+(\.?_?\d+)+)/i,no=[{test:[/googlebot/i],describe(e){const t={name:"Googlebot"},n=a.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||a.getFirstMatch(R,e);return n&&(t.version=n),t}},{test:[/opera/i],describe(e){const t={name:"Opera"},n=a.getFirstMatch(R,e)||a.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe(e){const t={name:"Opera"},n=a.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||a.getFirstMatch(R,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe(e){const t={name:"Samsung Internet for Android"},n=a.getFirstMatch(R,e)||a.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe(e){const t={name:"NAVER Whale Browser"},n=a.getFirstMatch(R,e)||a.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe(e){const t={name:"MZ Browser"},n=a.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||a.getFirstMatch(R,e);return n&&(t.version=n),t}},{test:[/focus/i],describe(e){const t={name:"Focus"},n=a.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||a.getFirstMatch(R,e);return n&&(t.version=n),t}},{test:[/swing/i],describe(e){const t={name:"Swing"},n=a.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||a.getFirstMatch(R,e);return n&&(t.version=n),t}},{test:[/coast/i],describe(e){const t={name:"Opera Coast"},n=a.getFirstMatch(R,e)||a.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(e){const t={name:"Opera Touch"},n=a.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||a.getFirstMatch(R,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe(e){const t={name:"Yandex Browser"},n=a.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||a.getFirstMatch(R,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe(e){const t={name:"UC Browser"},n=a.getFirstMatch(R,e)||a.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe(e){const t={name:"Maxthon"},n=a.getFirstMatch(R,e)||a.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe(e){const t={name:"Epiphany"},n=a.getFirstMatch(R,e)||a.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe(e){const t={name:"Puffin"},n=a.getFirstMatch(R,e)||a.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe(e){const t={name:"Sleipnir"},n=a.getFirstMatch(R,e)||a.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe(e){const t={name:"K-Meleon"},n=a.getFirstMatch(R,e)||a.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe(e){const t={name:"WeChat"},n=a.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||a.getFirstMatch(R,e);return n&&(t.version=n),t}},{test:[/qqbrowser/i],describe(e){const t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},n=a.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||a.getFirstMatch(R,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe(e){const t={name:"Internet Explorer"},n=a.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe(e){const t={name:"Microsoft Edge"},n=a.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe(e){const t={name:"Microsoft Edge"},n=a.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe(e){const t={name:"Vivaldi"},n=a.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe(e){const t={name:"SeaMonkey"},n=a.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe(e){const t={name:"Sailfish"},n=a.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe(e){const t={name:"Amazon Silk"},n=a.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe(e){const t={name:"PhantomJS"},n=a.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe(e){const t={name:"SlimerJS"},n=a.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(e){const t={name:"BlackBerry"},n=a.getFirstMatch(R,e)||a.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe(e){const t={name:"WebOS Browser"},n=a.getFirstMatch(R,e)||a.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe(e){const t={name:"Bada"},n=a.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe(e){const t={name:"Tizen"},n=a.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||a.getFirstMatch(R,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe(e){const t={name:"QupZilla"},n=a.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||a.getFirstMatch(R,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe(e){const t={name:"Firefox"},n=a.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe(e){const t={name:"Electron"},n=a.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MiuiBrowser/i],describe(e){const t={name:"Miui"},n=a.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe(e){const t={name:"Chromium"},n=a.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||a.getFirstMatch(R,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe(e){const t={name:"Chrome"},n=a.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/GSA/i],describe(e){const t={name:"Google Search"},n=a.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test(e){const t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe(e){const t={name:"Android Browser"},n=a.getFirstMatch(R,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe(e){const t={name:"PlayStation 4"},n=a.getFirstMatch(R,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe(e){const t={name:"Safari"},n=a.getFirstMatch(R,e);return n&&(t.version=n),t}},{test:[/.*/i],describe(e){const t=/^(.*)\/(.*) /,n=/^(.*)\/(.*)[ \t]\((.*)/,s=e.search("\\(")!==-1?n:t;return{name:a.getFirstMatch(s,e),version:a.getSecondMatch(s,e)}}}],ro=[{test:[/Roku\/DVP/],describe(e){const t=a.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:U.Roku,version:t}}},{test:[/windows phone/i],describe(e){const t=a.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:U.WindowsPhone,version:t}}},{test:[/windows /i],describe(e){const t=a.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),n=a.getWindowsVersionName(t);return{name:U.Windows,version:t,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(e){const t={name:U.iOS},n=a.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return n&&(t.version=n),t}},{test:[/macintosh/i],describe(e){const t=a.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),n=a.getMacOSVersionName(t),r={name:U.MacOS,version:t};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe(e){const t=a.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:U.iOS,version:t}}},{test(e){const t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe(e){const t=a.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),n=a.getAndroidVersionName(t),r={name:U.Android,version:t};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe(e){const t=a.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:U.WebOS};return t&&t.length&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(e){const t=a.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||a.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||a.getFirstMatch(/\bbb(\d+)/i,e);return{name:U.BlackBerry,version:t}}},{test:[/bada/i],describe(e){const t=a.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:U.Bada,version:t}}},{test:[/tizen/i],describe(e){const t=a.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:U.Tizen,version:t}}},{test:[/linux/i],describe(){return{name:U.Linux}}},{test:[/CrOS/],describe(){return{name:U.ChromeOS}}},{test:[/PlayStation 4/],describe(e){const t=a.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:U.PlayStation4,version:t}}}],so=[{test:[/googlebot/i],describe(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe(e){const t=a.getFirstMatch(/(can-l01)/i,e)&&"Nova",n={type:T.mobile,vendor:"Huawei"};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe(){return{type:T.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe(){return{type:T.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(){return{type:T.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe(){return{type:T.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe(){return{type:T.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe(){return{type:T.tablet}}},{test(e){const t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe(e){const t=a.getFirstMatch(/(ipod|iphone)/i,e);return{type:T.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe(){return{type:T.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe(){return{type:T.mobile}}},{test(e){return e.getBrowserName(!0)==="blackberry"},describe(){return{type:T.mobile,vendor:"BlackBerry"}}},{test(e){return e.getBrowserName(!0)==="bada"},describe(){return{type:T.mobile}}},{test(e){return e.getBrowserName()==="windows phone"},describe(){return{type:T.mobile,vendor:"Microsoft"}}},{test(e){const t=Number(String(e.getOSVersion()).split(".")[0]);return e.getOSName(!0)==="android"&&t>=3},describe(){return{type:T.tablet}}},{test(e){return e.getOSName(!0)==="android"},describe(){return{type:T.mobile}}},{test(e){return e.getOSName(!0)==="macos"},describe(){return{type:T.desktop,vendor:"Apple"}}},{test(e){return e.getOSName(!0)==="windows"},describe(){return{type:T.desktop}}},{test(e){return e.getOSName(!0)==="linux"},describe(){return{type:T.desktop}}},{test(e){return e.getOSName(!0)==="playstation 4"},describe(){return{type:T.tv}}},{test(e){return e.getOSName(!0)==="roku"},describe(){return{type:T.tv}}}],oo=[{test(e){return e.getBrowserName(!0)==="microsoft edge"},describe(e){if(/\sedg\//i.test(e))return{name:ue.Blink};const n=a.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:ue.EdgeHTML,version:n}}},{test:[/trident/i],describe(e){const t={name:ue.Trident},n=a.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test(e){return e.test(/presto/i)},describe(e){const t={name:ue.Presto},n=a.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test(e){const t=e.test(/gecko/i),n=e.test(/like gecko/i);return t&&!n},describe(e){const t={name:ue.Gecko},n=a.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(apple)?webkit\/537\.36/i],describe(){return{name:ue.Blink}}},{test:[/(apple)?webkit/i],describe(e){const t={name:ue.WebKit},n=a.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}}];class pt{constructor(t,n=!1){if(t==null||t==="")throw new Error("UserAgent parameter can't be empty");this._ua=t,this.parsedResult={},n!==!0&&this.parse()}getUA(){return this._ua}test(t){return t.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const t=a.find(no,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(t){return t?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const t=a.find(ro,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os}getOSName(t){const{name:n}=this.getOS();return t?String(n).toLowerCase()||"":n||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(t=!1){const{type:n}=this.getPlatform();return t?String(n).toLowerCase()||"":n||""}parsePlatform(){this.parsedResult.platform={};const t=a.find(so,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(t){return t?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const t=a.find(oo,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return a.assign({},this.parsedResult)}satisfies(t){const n={};let r=0;const s={};let i=0;if(Object.keys(t).forEach(f=>{const m=t[f];typeof m=="string"?(s[f]=m,i+=1):typeof m=="object"&&(n[f]=m,r+=1)}),r>0){const f=Object.keys(n),m=a.find(f,k=>this.isOS(k));if(m){const k=this.satisfies(n[m]);if(k!==void 0)return k}const $=a.find(f,k=>this.isPlatform(k));if($){const k=this.satisfies(n[$]);if(k!==void 0)return k}}if(i>0){const f=Object.keys(s),m=a.find(f,$=>this.isBrowser($,!0));if(m!==void 0)return this.compareVersion(s[m])}}isBrowser(t,n=!1){const r=this.getBrowserName().toLowerCase();let s=t.toLowerCase();const i=a.getBrowserTypeByAlias(s);return n&&i&&(s=i.toLowerCase()),s===r}compareVersion(t){let n=[0],r=t,s=!1;const i=this.getBrowserVersion();if(typeof i=="string")return t[0]===">"||t[0]==="<"?(r=t.substr(1),t[1]==="="?(s=!0,r=t.substr(2)):n=[],t[0]===">"?n.push(1):n.push(-1)):t[0]==="="?r=t.substr(1):t[0]==="~"&&(s=!0,r=t.substr(1)),n.indexOf(a.compareVersions(i,r,s))>-1}isOS(t){return this.getOSName(!0)===String(t).toLowerCase()}isPlatform(t){return this.getPlatformType(!0)===String(t).toLowerCase()}isEngine(t){return this.getEngineName(!0)===String(t).toLowerCase()}is(t,n=!1){return this.isBrowser(t,n)||this.isOS(t)||this.isPlatform(t)}some(t=[]){return t.some(n=>this.is(n))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class io{static getParser(t,n=!1){if(typeof t!="string")throw new Error("UserAgent should be a string");return new pt(t,n)}static parse(t){return new pt(t).getResult()}static get BROWSER_MAP(){return Ot}static get ENGINE_MAP(){return ue}static get OS_MAP(){return U}static get PLATFORMS_MAP(){return T}}var Tt={};Object.defineProperty(Tt,"__esModule",{value:!0});const Fe=fe,ao={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},lo=(0,Fe.createElementVNode)("path",{d:"M13 21h13.17l-2.58 2.59L25 25l5-5l-5-5l-1.41 1.41L26.17 19H13v2z",fill:"currentColor"},null,-1),uo=(0,Fe.createElementVNode)("path",{d:"M22 14v-4a1 1 0 0 0-.29-.71l-7-7A1 1 0 0 0 14 2H4a2 2 0 0 0-2 2v24a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2h-2v2H4V4h8v6a2 2 0 0 0 2 2h6v2zm-8-4V4.41L19.59 10z",fill:"currentColor"},null,-1),co=[lo,uo];var fo=Tt.default=(0,Fe.defineComponent)({name:"DocumentExport",render:function(t,n){return(0,Fe.openBlock)(),(0,Fe.createElementBlock)("svg",ao,co)}}),Vt={};Object.defineProperty(Vt,"__esModule",{value:!0});const Be=fe,po={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},mo=(0,Be.createElementVNode)("path",{d:"M28 19H14.83l2.58-2.59L16 15l-5 5l5 5l1.41-1.41L14.83 21H28v-2z",fill:"currentColor"},null,-1),ho=(0,Be.createElementVNode)("path",{d:"M24 14v-4a1 1 0 0 0-.29-.71l-7-7A1 1 0 0 0 16 2H6a2 2 0 0 0-2 2v24a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2h-2v2H6V4h8v6a2 2 0 0 0 2 2h6v2zm-8-4V4.41L21.59 10z",fill:"currentColor"},null,-1),go=[mo,ho];var _o=Vt.default=(0,Be.defineComponent)({name:"DocumentImport",render:function(t,n){return(0,Be.openBlock)(),(0,Be.createElementBlock)("svg",po,go)}}),Lt={};Object.defineProperty(Lt,"__esModule",{value:!0});const Ae=fe,vo={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 512 512","enable-background":"new 0 0 512 512","xml:space":"preserve"},bo=(0,Ae.createElementVNode)("path",{d:`M217.9,256L345,129c9.4-9.4,9.4-24.6,0-33.9c-9.4-9.4-24.6-9.3-34,0L167,239c-9.1,9.1-9.3,23.7-0.7,33.1L310.9,417
	c4.7,4.7,10.9,7,17,7c6.1,0,12.3-2.3,17-7c9.4-9.4,9.4-24.6,0-33.9L217.9,256z`},null,-1),wo=[bo];var yo=Lt.default=(0,Ae.defineComponent)({name:"IosArrowBack",render:function(t,n){return(0,Ae.openBlock)(),(0,Ae.createElementBlock)("svg",vo,wo)}}),It={};Object.defineProperty(It,"__esModule",{value:!0});const Oe=fe,xo={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 512 512","enable-background":"new 0 0 512 512","xml:space":"preserve"},So=(0,Oe.createElementVNode)("path",{d:`M294.1,256L167,129c-9.4-9.4-9.4-24.6,0-33.9s24.6-9.3,34,0L345,239c9.1,9.1,9.3,23.7,0.7,33.1L201.1,417
	c-4.7,4.7-10.9,7-17,7c-6.1,0-12.3-2.3-17-7c-9.4-9.4-9.4-24.6,0-33.9L294.1,256z`},null,-1),ko=[So];var Mo=It.default=(0,Oe.defineComponent)({name:"IosArrowForward",render:function(t,n){return(0,Oe.openBlock)(),(0,Oe.createElementBlock)("svg",xo,ko)}}),Nt={};Object.defineProperty(Nt,"__esModule",{value:!0});const _e=fe,Co={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},$o=(0,_e.createElementVNode)("path",{d:"M160 389a20.91 20.91 0 0 1-13.82-5.2l-128-112a21 21 0 0 1 0-31.6l128-112a21 21 0 0 1 27.66 31.61L63.89 256l109.94 96.19A21 21 0 0 1 160 389z",fill:"currentColor"},null,-1),Fo=(0,_e.createElementVNode)("path",{d:"M352 389a21 21 0 0 1-13.84-36.81L448.11 256l-109.94-96.19a21 21 0 0 1 27.66-31.61l128 112a21 21 0 0 1 0 31.6l-128 112A20.89 20.89 0 0 1 352 389z",fill:"currentColor"},null,-1),Bo=(0,_e.createElementVNode)("path",{d:"M208 437a21 21 0 0 1-20.12-27l96-320a21 21 0 1 1 40.23 12l-96 320A21 21 0 0 1 208 437z",fill:"currentColor"},null,-1),Eo=[$o,Fo,Bo];var Ro=Nt.default=(0,_e.defineComponent)({name:"CodeSlash",render:function(t,n){return(0,_e.openBlock)(),(0,_e.createElementBlock)("svg",Co,Eo)}}),Dt={};Object.defineProperty(Dt,"__esModule",{value:!0});const Te=fe,Po={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Ao=(0,Te.createElementVNode)("path",{d:"M21.29 5.89l-10 10a.996.996 0 0 1-1.41 0l-2.83-2.83a.996.996 0 1 1 1.41-1.41l2.12 2.12l9.29-9.29a.996.996 0 0 1 1.41 0c.4.39.4 1.02.01 1.41zM12 20c-4.71 0-8.48-4.09-7.95-8.9c.39-3.52 3.12-6.41 6.61-6.99c1.81-.3 3.53.02 4.99.78a1.003 1.003 0 0 0 .93-1.78c-1.47-.75-3.13-1.16-4.9-1.11c-5.14.16-9.41 4.34-9.67 9.47C1.72 17.24 6.3 22 12 22c1.2 0 2.34-.21 3.41-.6c.68-.25.87-1.13.35-1.65a.98.98 0 0 0-1.04-.23c-.85.31-1.77.48-2.72.48zm7-5h-2c-.55 0-1 .45-1 1s.45 1 1 1h2v2c0 .55.45 1 1 1s1-.45 1-1v-2h2c.55 0 1-.45 1-1s-.45-1-1-1h-2v-2c0-.55-.45-1-1-1s-1 .45-1 1v2z",fill:"currentColor"},null,-1),Oo=[Ao];var To=Dt.default=(0,Te.defineComponent)({name:"AddTaskRound",render:function(t,n){return(0,Te.openBlock)(),(0,Te.createElementBlock)("svg",Po,Oo)}}),zt={};Object.defineProperty(zt,"__esModule",{value:!0});const Ve=fe,Vo={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Lo=(0,Ve.createElementVNode)("path",{d:"M18 12.998h-5v5a1 1 0 0 1-2 0v-5H6a1 1 0 0 1 0-2h5v-5a1 1 0 0 1 2 0v5h5a1 1 0 0 1 0 2z",fill:"currentColor"},null,-1),Io=[Lo];var No=zt.default=(0,Ve.defineComponent)({name:"PlusRound",render:function(t,n){return(0,Ve.openBlock)(),(0,Ve.createElementBlock)("svg",Vo,Io)}});const j=e=>(Qe("data-v-d6372713"),e=e(),Je(),e),Do={class:"plan-bar w-980 mx-auto mt-12 mw-980"},zo=j(()=>l("span",null,"令夕模式",-1)),Uo=j(()=>l("div",null,"令夕上班时起作用",-1)),jo=j(()=>l("div",null,"启动Mower前需要手动对齐心情",-1)),Wo=j(()=>l("div",null,"感知：夕心情-令心情=12",-1)),qo=j(()=>l("div",null,"烟火：令心情-夕心情=12",-1)),Ho=j(()=>l("div",null,"均衡：夕令心情一样",-1)),Go=j(()=>l("span",null,"最大组人数",-1)),Ko=j(()=>l("span",null,"需要回满心情的干员",-1)),Qo=j(()=>l("span",null,"需要用尽心情的干员",-1)),Jo=j(()=>l("span",null,"0心情工作的干员",-1)),Xo=j(()=>l("span",null,"宿舍低优先级干员",-1)),Zo=j(()=>l("span",null,"跑单时间刷新干员",-1)),Yo=j(()=>l("p",null,"贸易站外影响贸易效率的干员",-1)),ei=j(()=>l("p",null,[E(" 默认情况下，mower 只在贸易站内干员换班后重读所有贸易站的订单剩余时间。"),l("br"),E(" 若有贸易站外的干员影响贸易效率，且与贸易站内的干员不在一组，则需写入此选项中。 ")],-1)),ti=j(()=>l("span",null,"宿舍黑名单",-1)),ni={__name:"Plan",setup(e){const t=wt(),{free_blacklist:n,theme:r}=ve(t),s=Ne(),{ling_xi:i,max_resting_count:o,resting_priority:f,exhaust_require:m,rest_in_full:$,workaholic:k,backup_plans:C,sub_plan:x,refresh_trading:I}=ve(s),{load_plan:h,fill_empty:G}=s,w=de("axios"),F=D("");Re("facility",F);const N=D(null),Y=D(!1),ne=Nn(),ee=In();async function be(){Y.value=!0,ee.start(),F.value!=""&&(F.value="",await us(500));const v=io.getParser(window.navigator.userAgent);let c;v.getEngine().name=="WebKit"&&(c=await ft(N.value.outer)),c=await ft(N.value.outer,{pixelRatio:3,backgroundColor:r.value=="light"?"#ffffff":"#000000",style:{margin:0,padding:"8px 0"}}),Y.value=!1,ee.finish();const S=new FormData;S.append("img",c);const{data:X}=await w.post("/dialog/save/img",S,{responseType:"blob"}),g=window.URL.createObjectURL(X),y=document.createElement("a");y.href=g,y.setAttribute("download","plan.jpg"),document.body.appendChild(y),y.click(),document.body.removeChild(y),window.URL.revokeObjectURL(g)}const we=de("mobile"),ye=L(()=>{const v=[{label:"主表",value:"main"}];for(let c=0;c<C.value.length;c++)v.push({label:`副表${c+1}`,value:c});return v});function W(){C.value.push({conf:{exhaust_require:ge(m.value),free_blacklist:ge(n.value),ling_xi:i.value,max_resting_count:o.value,rest_in_full:ge($.value),resting_priority:ge(f.value),workaholic:ge(k.value),refresh_trading:ge(I.value)},plan:G({}),trigger:{left:"",operator:"",right:""},trigger_timing:"AFTER_PLANNING",task:{}}),x.value=C.value.length-1}function xe(){C.value.splice(x.value,1),x.value="main"}const B=D({ling_xi:i.value,max_resting_count:o.value,rest_in_full:$.value,resting_priority:f.value,workaholic:k.value,exhaust_require:m.value,refresh_trading:I.value});rt(()=>{x.value=="main"?B.value={ling_xi:i.value,max_resting_count:o.value,rest_in_full:$.value,resting_priority:f.value,workaholic:k.value,exhaust_require:m.value,refresh_trading:I.value}:B.value=C.value[x.value].conf}),rt(()=>{x.value=="main"?(i.value=B.value.ling_xi,o.value=B.value.max_resting_count,$.value=B.value.rest_in_full,m.value=B.value.exhaust_require,f.value=B.value.resting_priority,k.value=B.value.workaholic,I.value=B.value.refresh_trading):C.value[x.value].conf=B.value});const ce=D(!1);Re("show_trigger_editor",ce);const pe=D(!1),Se=D(!1);Re("show_task",pe),Re("add_task",Se);function ke({event:v}){const c=v.target.response;c=="排班已加载"?(x.value="main",h(),ne.success("成功导入排班表！")):ne.error(c)}const Me="/import",Ce=de("token"),$e=[{label:"导出JSON文件",key:"json"}];async function q(){const{data:v}=await w.get("/export-json",{responseType:"blob"});console.log(v);const c=window.URL.createObjectURL(v),S=document.createElement("a");S.href=c,S.setAttribute("download","plan.json"),document.body.appendChild(S),S.click(),document.body.removeChild(S),window.URL.revokeObjectURL(c)}return(v,c)=>{const S=ls,X=Rn,g=cn,y=vt,z=Sn,Z=Ee,ae=Ht,_=En,P=Hr,A=He,ze=An,Ut=St,jt=On,le=ht,Wt=kn,me=mt,qt=Gt;return b(),M(V,null,[d(S),d(X),l("div",Do,[d(z,null,{default:p(()=>[d(y,{disabled:u(x)=="main",onClick:c[0]||(c[0]=O=>x.value=u(x)==0?"main":u(x)-1)},{icon:p(()=>[d(g,null,{default:p(()=>[d(u(yo))]),_:1})]),_:1},8,["disabled"]),d(y,{disabled:u(x)==u(C).length-1||u(C).length==0,onClick:c[1]||(c[1]=O=>x.value=u(x)=="main"?0:u(x)+1)},{icon:p(()=>[d(g,null,{default:p(()=>[d(u(Mo))]),_:1})]),_:1},8,["disabled"])]),_:1}),d(Z,{value:u(x),"onUpdate:value":c[2]||(c[2]=O=>bt(x)?x.value=O:null),options:ye.value},null,8,["value","options"]),d(z,null,{default:p(()=>[d(y,{onClick:W},{icon:p(()=>[d(g,{size:22},{default:p(()=>[d(u(No))]),_:1})]),default:p(()=>[E(" 新建副表 ")]),_:1}),d(y,{disabled:u(x)=="main",onClick:c[3]||(c[3]=O=>ce.value=!0)},{icon:p(()=>[d(g,null,{default:p(()=>[d(u(Ro))]),_:1})]),default:p(()=>[E(" 编辑触发条件 ")]),_:1},8,["disabled"]),d(y,{disabled:u(x)=="main",onClick:c[4]||(c[4]=O=>pe.value=!0)},{icon:p(()=>[d(g,null,{default:p(()=>[d(u(To))]),_:1})]),default:p(()=>[E(" 编辑任务 ")]),_:1},8,["disabled"]),d(y,{disabled:u(x)=="main",onClick:xe},{icon:p(()=>[d(g,null,{default:p(()=>[d(u(Pn))]),_:1})]),default:p(()=>[E(" 删除此副表 ")]),_:1},8,["disabled"])]),_:1}),d(ae,{style:{width:"auto","margin-left":"8px"},action:Me,headers:{token:u(Ce)},"show-file-list":!1,name:"img",onFinish:ke},{default:p(()=>[d(y,null,{icon:p(()=>[d(g,null,{default:p(()=>[d(u(_o))]),_:1})]),default:p(()=>[E(" 导入排班 ")]),_:1})]),_:1},8,["headers"]),d(_,{select:q,options:$e},{default:p(()=>[d(y,{onClick:be,loading:Y.value,disabled:Y.value},{icon:p(()=>[d(g,null,{default:p(()=>[d(u(fo))]),_:1})]),default:p(()=>[E(" 导出图片 ")]),_:1},8,["loading","disabled"])]),_:1})]),d(P,{ref_key:"plan_editor",ref:N,class:"w-980 mx-auto mw-980 px-12"},null,512),d(qt,{class:"w-980 mx-auto mb-12 px-12 mw-980","label-placement":u(we)?"top":"left","show-feedback":!1,"label-width":"160","label-align":"left"},{default:p(()=>[d(le,null,{label:p(()=>[zo,d(A,null,{default:p(()=>[Uo,jo,Wo,qo,Ho]),_:1})]),default:p(()=>[d(jt,{value:B.value.ling_xi,"onUpdate:value":c[5]||(c[5]=O=>B.value.ling_xi=O)},{default:p(()=>[d(Ut,null,{default:p(()=>[d(ze,{value:1},{default:p(()=>[E("感知信息")]),_:1}),d(ze,{value:2},{default:p(()=>[E("人间烟火")]),_:1}),d(ze,{value:3},{default:p(()=>[E("均衡模式")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),d(le,null,{label:p(()=>[Go,d(A,null,{default:p(()=>[E("请查阅文档")]),_:1})]),default:p(()=>[d(Wt,{value:B.value.max_resting_count,"onUpdate:value":c[6]||(c[6]=O=>B.value.max_resting_count=O)},{suffix:p(()=>[E("人")]),_:1},8,["value"])]),_:1}),d(le,null,{label:p(()=>[Ko,d(A,null,{default:p(()=>[E("请查阅文档")]),_:1})]),default:p(()=>[d(me,{modelValue:B.value.rest_in_full,"onUpdate:modelValue":c[7]||(c[7]=O=>B.value.rest_in_full=O)},null,8,["modelValue"])]),_:1}),d(le,null,{label:p(()=>[Qo,d(A,null,{default:p(()=>[E("仅推荐写入具有暖机技能的干员")]),_:1})]),default:p(()=>[d(me,{modelValue:B.value.exhaust_require,"onUpdate:modelValue":c[8]||(c[8]=O=>B.value.exhaust_require=O)},null,8,["modelValue"])]),_:1}),d(le,null,{label:p(()=>[Jo,d(A,null,{default:p(()=>[E("心情涣散状态仍能触发技能的干员")]),_:1})]),default:p(()=>[d(me,{modelValue:B.value.workaholic,"onUpdate:modelValue":c[9]||(c[9]=O=>B.value.workaholic=O)},null,8,["modelValue"])]),_:1}),d(le,null,{label:p(()=>[Xo,d(A,null,{default:p(()=>[E("请查阅文档")]),_:1})]),default:p(()=>[d(me,{modelValue:B.value.resting_priority,"onUpdate:modelValue":c[10]||(c[10]=O=>B.value.resting_priority=O)},null,8,["modelValue"])]),_:1}),d(le,null,{label:p(()=>[Zo,d(A,null,{default:p(()=>[Yo,ei]),_:1})]),default:p(()=>[d(me,{modelValue:B.value.refresh_trading,"onUpdate:modelValue":c[11]||(c[11]=O=>B.value.refresh_trading=O),select_placeholder:"填入在贸易站外影响贸易效率的干员"},null,8,["modelValue"])]),_:1}),u(x)!="main"?(b(),oe(le,{key:0},{label:p(()=>[ti,d(A,null,{default:p(()=>[E("不希望进行填充宿舍的干员")]),_:1})]),default:p(()=>[d(me,{modelValue:B.value.free_blacklist,"onUpdate:modelValue":c[12]||(c[12]=O=>B.value.free_blacklist=O)},null,8,["modelValue"])]),_:1})):se("",!0)]),_:1},8,["label-placement"])],64)}}},bi=Ge(ni,[["__scopeId","data-v-d6372713"]]);export{bi as default};
